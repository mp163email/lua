---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by wangyu.
--- DateTime: 2019-2-22 11:40
---  对于一些操作，通常在外面定义一个table, 来表示某些东西比如定义一个 Set = {a = true, b = true}， 可以记录所有声明过的变量
print("aaaa")
local declared = {}

local mt = {}
setmetatable(_G, mt)
function mt.__index(t, k)
    if not declared[k] then
        print("aaaaaaaaaa")
        error("访问了一个未定义的全局变量")
    end
end
print(sdfsdf)
function mt.__newindex (t, k, v)
    if not declared[k] then
        local w = debug.getinfo(2, "S").what
        if w ~= "main" then
            error("只能在main块中对全局变量赋值")
        end
        declared[k] = true
    end
    rawset(t, k, v)
end
--mt.__index = myIndex
--mt.__newindex = myNewIndex

a = "aaa"
print(b)