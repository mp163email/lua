---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by wangyu.
--- DateTime: 2019-2-22 9:28
--- 全局变量存在一个名为_G的table中。
print(a)--全局变量定义在后面也可以, 也能找得到
a = "bbb"

---打印所有全局变量
--for i, v in pairs(_G) do
--    print(i, v)
--end

print"-----不允许对未定义的全局变量访问和赋值-----"
setmetatable(_G, {
            __index = function (t, k)
                error("不允许访问未定义的key")
            end,
            __newindex = function (t, k, v)
                local caller = debug.getinfo(2, "S").what
                print("the caller is " , caller)
                if caller ~= "main" then
                    error("不允许修改值")
                else
                    rawset(t, k, v)--通过rawset直接给table赋值，可以绕过元方法
                end
            end
        }
 )
b = "ccc"--会报错
print(d)--会报错
